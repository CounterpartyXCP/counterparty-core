# Transactions executed to generate the database used by unit tests

from .params import ADDR, MULTISIGADDR, P2SH_ADDR, P2WPKH_ADDR
from .params import DEFAULT_PARAMS as DP

UNITTEST_FIXTURE = [
    [
        "burn",
        {
            "source": ADDR[0],
            "quantity": DP["burn_quantity"],
            "overburn": False,
        },
        {"encoding": "multisig"},
    ],
    [
        "issuance",
        {
            "source": ADDR[0],
            "asset": "DIVISIBLE",
            "quantity": DP["quantity"] * 1000,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "Divisible asset",
        },
        {"encoding": "multisig"},
    ],
    [
        "issuance",
        {
            "source": ADDR[0],
            "asset": "NODIVISIBLE",
            "quantity": 1000,
            "transfer_destination": None,
            "divisible": False,
            "lock": None,
            "reset": None,
            "description": "No divisible asset",
        },
        {"encoding": "multisig"},
    ],
    [
        "issuance",
        {
            "source": ADDR[0],
            "asset": "CALLABLE",
            "quantity": 1000,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "Callable asset",
        },
        {"encoding": "multisig"},
    ],
    [
        "issuance",
        {
            "source": ADDR[0],
            "asset": "LOCKED",
            "quantity": 1000,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "Locked asset",
        },
        {"encoding": "multisig"},
    ],
    [
        "issuance",
        {
            "source": ADDR[0],
            "asset": "LOCKED",
            "quantity": 0,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "LOCK",
        },
        {"encoding": "multisig"},
    ],
    [
        "order",
        {
            "source": ADDR[0],
            "give_asset": "XCP",
            "give_quantity": DP["quantity"],
            "get_asset": "DIVISIBLE",
            "get_quantity": DP["quantity"],
            "expiration": 2000,
            "fee_required": 0,
        },
        {"encoding": "multisig"},
    ],
    [
        "send",
        {
            "source": ADDR[0],
            "destination": ADDR[1],
            "asset": "DIVISIBLE",
            "quantity": DP["quantity"],
        },
        {"encoding": "multisig"},
        ["enhanced_sends"],
    ],
    [
        "send",
        {"source": ADDR[0], "destination": ADDR[1], "asset": "XCP", "quantity": DP["quantity"]},
        {"encoding": "multisig"},
        ["enhanced_sends"],
    ],
    [
        "order",
        {
            "source": ADDR[0],
            "give_asset": "XCP",
            "give_quantity": DP["quantity"],
            "get_asset": "DIVISIBLE",
            "get_quantity": DP["quantity"],
            "expiration": 2000,
            "fee_required": 0,
        },
        {"encoding": "multisig"},
    ],
    [
        "order",
        {
            "source": ADDR[0],
            "give_asset": "XCP",
            "give_quantity": DP["quantity"],
            "get_asset": "BTC",
            "get_quantity": round(DP["quantity"] / 100),
            "expiration": 2000,
            "fee_required": DP["fee_required"],
        },
        {"encoding": "multisig"},
    ],
    [
        "order",
        {
            "source": ADDR[0],
            "give_asset": "BTC",
            "give_quantity": round(DP["quantity"] / 150),
            "get_asset": "XCP",
            "get_quantity": DP["quantity"],
            "expiration": 2000,
            "fee_required": 0,
        },
        {"encoding": "multisig", "fee_provided": DP["fee_provided"]},
    ],
    [
        "send",
        {
            "source": ADDR[0],
            "destination": MULTISIGADDR[0],
            "asset": "XCP",
            "quantity": DP["quantity"] * 3,
        },
        {"encoding": "multisig"},
        ["enhanced_sends"],
    ],
    [
        "send",
        {
            "source": ADDR[0],
            "destination": MULTISIGADDR[0],
            "asset": "DIVISIBLE",
            "quantity": DP["quantity"] * 10,
        },
        {"encoding": "multisig"},
        ["enhanced_sends"],
    ],
    [
        "send",
        {"source": ADDR[0], "destination": ADDR[1], "asset": "NODIVISIBLE", "quantity": 5},
        {"encoding": "multisig"},
        ["enhanced_sends"],
    ],
    [
        "send",
        {"source": ADDR[0], "destination": MULTISIGADDR[0], "asset": "NODIVISIBLE", "quantity": 10},
        {"encoding": "multisig"},
        ["enhanced_sends"],
    ],
    [
        "issuance",
        {
            "source": ADDR[0],
            "asset": "MAXI",
            "quantity": 2**63 - 1,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "Maximum quantity",
        },
        {"encoding": "multisig"},
    ],
    [
        "broadcast",
        {
            "source": ADDR[0],
            "timestamp": 1388000000,
            "value": 1,
            "fee_fraction": DP["fee_multiplier"],
            "text": "Unit Test",
        },
        {"encoding": "multisig"},
    ],
    [
        "broadcast",
        {
            "source": ADDR[2],
            "timestamp": 1288000000,
            "value": 1,
            "fee_fraction": 0.0,
            "text": "lock",
        },
        {"encoding": "multisig"},
    ],
    [
        "bet",
        {
            "source": ADDR[0],
            "feed_address": ADDR[0],
            "bet_type": 1,
            "deadline": 1388000001,
            "wager_quantity": 9,
            "counterwager_quantity": 9,
            "target_value": 0.0,
            "leverage": 5040,
            "expiration": 100,
        },
        {"encoding": "multisig"},
    ],
    [
        "bet",
        {
            "source": ADDR[1],
            "feed_address": ADDR[0],
            "bet_type": 0,
            "deadline": 1388000001,
            "wager_quantity": 9,
            "counterwager_quantity": 9,
            "target_value": 0.0,
            "leverage": 5040,
            "expiration": 100,
        },
        {"encoding": "multisig"},
    ],
    ["mine_empty_blocks", 100],  # 310100
    [
        "bet",
        {
            "source": ADDR[1],
            "feed_address": ADDR[0],
            "bet_type": 3,
            "deadline": 1388000200,
            "wager_quantity": 10,
            "counterwager_quantity": 10,
            "target_value": 0.0,
            "leverage": 5040,
            "expiration": 1000,
        },
        {"encoding": "multisig"},
    ],
    [
        "broadcast",
        {
            "source": ADDR[0],
            "timestamp": 1388000002,
            "value": 1,
            "fee_fraction": DP["fee_multiplier"],
            "text": "Unit Test",
        },
        {"encoding": "multisig"},
    ],
    [
        "burn",
        {
            "source": ADDR[4],
            "quantity": DP["burn_quantity"],
        },
        {"encoding": "multisig"},
    ],
    [
        "burn",
        {
            "source": ADDR[5],
            "quantity": DP["burn_quantity"],
        },
        {"encoding": "multisig"},
    ],
    [
        "burn",
        {
            "source": ADDR[6],
            "quantity": DP["burn_quantity"],
        },
        {"encoding": "multisig"},
    ],
    [
        "burn",
        {
            "source": ADDR[8],
            "quantity": DP["burn_verysmall_quantity"],
        },
        {"encoding": "multisig"},
    ],
    [
        "dispenser",
        {
            "source": ADDR[5],
            "asset": "XCP",
            "give_quantity": 100,
            "escrow_quantity": 100,
            "mainchainrate": 100,
            "status": 0,
        },
        {"encoding": "opreturn"},
    ],
    [
        "burn",
        {
            "source": P2SH_ADDR[0],
            "quantity": int(DP["burn_quantity"] / 2),
        },
        {"encoding": "opreturn"},
    ],
    [
        "issuance",
        {
            "source": P2SH_ADDR[0],
            "asset": "PAYTOSCRIPT",
            "quantity": 1000,
            "transfer_destination": None,
            "divisible": False,
            "lock": None,
            "reset": None,
            "description": "PSH issued asset",
        },
        {"encoding": "multisig", "multisig_pubkey": DP["pubkey"][ADDR[0]]},
    ],
    [
        "send",
        {
            "source": ADDR[0],
            "destination": P2SH_ADDR[0],
            "asset": "DIVISIBLE",
            "quantity": DP["quantity"],
        },
        {"encoding": "multisig", "multisig_pubkey": DP["pubkey"][ADDR[0]]},
    ],
    [
        "broadcast",
        {
            "source": P2SH_ADDR[0],
            "timestamp": 1388000002,
            "value": 1,
            "fee_fraction": DP["fee_multiplier"],
            "text": "Unit Test",
        },
        {"encoding": "opreturn"},
    ],
    [
        "bet",
        {
            "source": P2SH_ADDR[0],
            "feed_address": P2SH_ADDR[0],
            "bet_type": 3,
            "deadline": 1388000200,
            "wager_quantity": 10,
            "counterwager_quantity": 10,
            "target_value": 0.0,
            "leverage": 5040,
            "expiration": 1000,
        },
        {"encoding": "opreturn"},
    ],
    # locked with an issuance after lock
    [
        "issuance",
        {
            "source": ADDR[6],
            "asset": "LOCKEDPREV",
            "quantity": 1000,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "Locked asset",
        },
        {"encoding": "multisig"},
    ],
    [
        "issuance",
        {
            "source": ADDR[6],
            "asset": "LOCKEDPREV",
            "quantity": 0,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "LOCK",
        },
        {"encoding": "multisig"},
    ],
    [
        "issuance",
        {
            "source": ADDR[6],
            "asset": "LOCKEDPREV",
            "quantity": 0,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "changed",
        },
        {"encoding": "multisig"},
    ],
    ["burn", {"source": P2WPKH_ADDR[0], "quantity": DP["burn_quantity"]}, {"encoding": "opreturn"}],
    ["mine_empty_blocks", 480],
    # force 2 enhanced sends
    [
        "send",
        {
            "source": ADDR[0],
            "destination": ADDR[1],
            "asset": "XCP",
            "quantity": DP["quantity"],
            "memo": "hello",
            "memo_is_hex": False,
            "use_enhanced_send": True,
        },
        {"encoding": "opreturn"},
    ],
    [
        "send",
        {
            "source": ADDR[1],
            "destination": ADDR[0],
            "asset": "XCP",
            "quantity": DP["quantity"],
            "memo": "fade0001",
            "memo_is_hex": True,
            "use_enhanced_send": True,
        },
        {"encoding": "opreturn"},
    ],
    ["mine_empty_blocks", 485],
    [
        "broadcast",
        {
            "source": ADDR[4],
            "timestamp": 1388000000,
            "value": 1,
            "fee_fraction": DP["fee_multiplier"],
            "text": "Unit Test",
        },
        {"encoding": "multisig"},
    ],
    [
        "bet",
        {
            "source": ADDR[4],
            "feed_address": ADDR[4],
            "bet_type": 1,
            "deadline": 1388000001,
            "wager_quantity": 9,
            "counterwager_quantity": 9,
            "target_value": 0.0,
            "leverage": 5040,
            "expiration": 100,
        },
        {"encoding": "multisig"},
    ],
    # To test REQUIRE_MEMO
    [
        "broadcast",
        {
            "source": ADDR[6],
            "timestamp": 1388000004,
            "value": 1,
            "fee_fraction": 0.0,
            "text": "options 1",
        },
        {"encoding": "multisig"},
        {"options_require_memo": True},
    ],
    [
        "broadcast",
        {
            "source": ADDR[6],
            "timestamp": 1388000004,
            "value": 1,
            "fee_fraction": 0.0,
            "text": "options 1",
        },
        {"encoding": "multisig"},
    ],
    # To test REQUIRE_MEMO
    [
        "broadcast",
        {
            "source": ADDR[6],
            "timestamp": 1388000004,
            "value": 1,
            "fee_fraction": 0.0,
            "text": "options 1",
        },
        {"encoding": "multisig"},
        {"options_require_memo": True},
    ],
    # ['mine_empty_blocks', 490],
    [
        "order",
        {
            "source": ADDR[0],
            "give_asset": "XCP",
            "give_quantity": DP["quantity"],
            "get_asset": "BTC",
            "get_quantity": round(DP["quantity"] / 125),
            "expiration": 2000,
            "fee_required": DP["fee_required"],
        },
        {"encoding": "multisig"},
    ],
    [
        "order",
        {
            "source": ADDR[1],
            "give_asset": "BTC",
            "give_quantity": round(DP["quantity"] / 125),
            "get_asset": "XCP",
            "get_quantity": DP["quantity"],
            "expiration": 2000,
            "fee_required": 0,
        },
        {"encoding": "multisig", "exact_fee": DP["fee_provided"]},
    ],
    ["burn", {"source": ADDR[2], "quantity": DP["burn_quantity"]}, {"encoding": "multisig"}],
    [
        "issuance",
        {
            "address": ADDR[2],
            "asset": "DIVIDEND",
            "quantity": 100,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "Test dividend",
        },
        {"encoding": "multisig"},
    ],
    [
        "send",
        {"source": ADDR[2], "destination": ADDR[3], "asset": "DIVIDEND", "quantity": 10},
        {"encoding": "multisig"},
    ],
    [
        "send",
        {"source": ADDR[2], "destination": ADDR[3], "asset": "XCP", "quantity": 92945878046},
        {"encoding": "multisig"},
    ],
    [
        "issuance",
        {
            "address": ADDR[0],
            "asset": "PARENT",
            "quantity": DP["quantity"] * 1,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "Parent asset",
        },
        {"encoding": "opreturn"},
    ],
    [
        "issuance",
        {
            "address": ADDR[0],
            "asset": "PARENT.already.issued",
            "quantity": DP["quantity"] * 1,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "Child of parent",
        },
        {"encoding": "opreturn"},
    ],
    [
        "fairminter",
        (ADDR[0], "FREEFAIRMIN", "", 0, 1, 10),
        {"encoding": "opreturn"},
        {"short_tx_type_id": True, "fairminter": True},
    ],
    [
        "fairminter",
        (ADDR[0], "PAIDFAIRMIN", "", 10, 1, 0),
        {"encoding": "opreturn"},
        {"short_tx_type_id": True, "fairminter": True},
    ],
    [
        "fairmint",
        (ADDR[0], "FREEFAIRMIN", 0),
        {"encoding": "opreturn"},
        {"short_tx_type_id": True, "fairminter": True},
    ],
    [
        "fairminter",
        (
            ADDR[0],  # source
            "RAIDFAIRMIN",  # asset
            "",  # asset_parent
            10,  # price
            1,  # quantity_by_price
            10,  # max_mint_per_tx
            30,  # hard_cap
            20,  # premint_quantity
        ),
        {"encoding": "opreturn"},
        {"short_tx_type_id": True, "fairminter": True},
    ],
    [
        "fairminter",
        (
            ADDR[0],  # source
            "QAIDFAIRMIN",  # asset
            "",  # asset_parent,
            10,  # price=0,
            1,  # quantity_by_price
            0,  # max_mint_per_tx,
            50,  # hard_cap=0,
            20,  # premint_quantity=0,
            0,  # start_block=0,
            0,  # end_block=0,
            20,  # soft_cap=0,
            400000,  # soft_cap_deadline_block=0,
            0.5,  # minted_asset_commission=0.0,
        ),
        {"encoding": "opreturn"},
        {"short_tx_type_id": True, "fairminter": True},
    ],
    [
        "fairminter",
        (
            ADDR[1],  # source
            "A160361285792733729",  # asset
            "",  # asset_parent,
            10,  # price=0,
            1,  # quantity_by_price
            0,  # max_mint_per_tx,
            50,  # hard_cap=0,
            20,  # premint_quantity=0,
            0,  # start_block=0,
            0,  # end_block=0,
            20,  # soft_cap=0,
            310520,  # soft_cap_deadline_block=0,
            0.3,  # minted_asset_commission=0.0,
            False,  # burn_payment=False,
            True,  # lock_description=False,
            True,  # lock_quantity
            True,  # divisible
            "softcap description",
        ),
        {"encoding": "multisig"},
        {"short_tx_type_id": True, "fairminter": True},
    ],
    [
        "fairmint",
        (ADDR[1], "A160361285792733729", 10),
        {"encoding": "opreturn"},
        {"short_tx_type_id": True, "fairminter": True},
    ],
    [
        "fairmint",
        (ADDR[1], "A160361285792733729", 20),
        {"encoding": "opreturn"},
        {"short_tx_type_id": True, "fairminter": True},
    ],
    [
        "attach",
        (ADDR[0], "XCP", 100),
        {"encoding": "multisig"},
        {"short_tx_type_id": True, "utxo_support": True, "spend_utxo_to_detach": True},
    ],
    [
        "attach",
        (
            ADDR[0],
            "DIVISIBLE",
            1,
        ),
        {"encoding": "multisig"},
        {"short_tx_type_id": True, "utxo_support": True, "spend_utxo_to_detach": True},
    ],
    [
        "issuance",
        (ADDR[5], "TESTDISP", 1000, None, False, None, None, "Test dispensers asset"),
        {"encoding": "multisig"},
    ],
    ["dispenser", (ADDR[5], "TESTDISP", 100, 100, 100, 0), {"encoding": "opreturn"}],
    ["mine_empty_blocks", 703],
]
