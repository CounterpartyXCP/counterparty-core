# Transactions executed to generate the database used by unit tests

from .params import DEFAULT_PARAMS as DP

# 3 or 4 elements by transaction:
# 1. Transaction name
# 2. Compose parameters
# 3. Transaction construct parameters
# 4. Optional list of protocol changes to disable
UNITTEST_FIXTURE = [
    [
        "burn",
        {
            "source": DP["addresses"][0],
            "quantity": DP["burn_quantity"],
            "overburn": False,
        },
        {"encoding": "multisig"},
    ],
    [
        "issuance",
        {
            "source": DP["addresses"][0],
            "asset": "DIVISIBLE",
            "quantity": DP["quantity"] * 1000,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "Divisible asset",
        },
        {"encoding": "multisig"},
    ],
    [
        "issuance",
        {
            "source": DP["addresses"][0],
            "asset": "NODIVISIBLE",
            "quantity": 1000,
            "transfer_destination": None,
            "divisible": False,
            "lock": None,
            "reset": None,
            "description": "No divisible asset",
        },
        {"encoding": "multisig"},
    ],
    [
        "issuance",
        {
            "source": DP["addresses"][0],
            "asset": "CALLABLE",
            "quantity": 1000,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "Callable asset",
        },
        {"encoding": "multisig"},
    ],
    [
        "issuance",
        {
            "source": DP["addresses"][0],
            "asset": "LOCKED",
            "quantity": 1000,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "Locked asset",
        },
        {"encoding": "multisig"},
    ],
    [
        "issuance",
        {
            "source": DP["addresses"][0],
            "asset": "LOCKED",
            "quantity": 0,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "LOCK",
        },
        {"encoding": "multisig"},
    ],
    [
        "order",
        {
            "source": DP["addresses"][0],
            "give_asset": "XCP",
            "give_quantity": DP["quantity"],
            "get_asset": "DIVISIBLE",
            "get_quantity": DP["quantity"],
            "expiration": 2000,
            "fee_required": 0,
        },
        {"encoding": "multisig"},
    ],
    [
        "send",
        {
            "source": DP["addresses"][0],
            "destination": DP["addresses"][1],
            "asset": "DIVISIBLE",
            "quantity": DP["quantity"],
        },
        {"encoding": "multisig"},
        ["enhanced_sends"],
    ],
    [
        "send",
        {
            "source": DP["addresses"][0],
            "destination": DP["addresses"][1],
            "asset": "XCP",
            "quantity": DP["quantity"],
        },
        {"encoding": "multisig"},
        ["enhanced_sends"],
    ],
    [
        "order",
        {
            "source": DP["addresses"][0],
            "give_asset": "XCP",
            "give_quantity": DP["quantity"],
            "get_asset": "DIVISIBLE",
            "get_quantity": DP["quantity"],
            "expiration": 2000,
            "fee_required": 0,
        },
        {"encoding": "multisig"},
    ],
    [
        "order",
        {
            "source": DP["addresses"][0],
            "give_asset": "XCP",
            "give_quantity": DP["quantity"],
            "get_asset": "BTC",
            "get_quantity": round(DP["quantity"] / 100),
            "expiration": 2000,
            "fee_required": DP["fee_required"],
        },
        {"encoding": "multisig"},
    ],
    [
        "order",
        {
            "source": DP["addresses"][0],
            "give_asset": "BTC",
            "give_quantity": round(DP["quantity"] / 150),
            "get_asset": "XCP",
            "get_quantity": DP["quantity"],
            "expiration": 2000,
            "fee_required": 0,
        },
        {"encoding": "multisig", "fee_provided": DP["fee_provided"]},
    ],
    [
        "send",
        {
            "source": DP["addresses"][0],
            "destination": DP["p2ms_addresses"][0],
            "asset": "XCP",
            "quantity": DP["quantity"] * 3,
        },
        {"encoding": "multisig"},
        ["enhanced_sends"],
    ],
    [
        "send",
        {
            "source": DP["addresses"][0],
            "destination": DP["p2ms_addresses"][0],
            "asset": "DIVISIBLE",
            "quantity": DP["quantity"] * 10,
        },
        {"encoding": "multisig"},
        ["enhanced_sends"],
    ],
    [
        "send",
        {
            "source": DP["addresses"][0],
            "destination": DP["addresses"][1],
            "asset": "NODIVISIBLE",
            "quantity": 5,
        },
        {"encoding": "multisig"},
        ["enhanced_sends"],
    ],
    [
        "send",
        {
            "source": DP["addresses"][0],
            "destination": DP["p2ms_addresses"][0],
            "asset": "NODIVISIBLE",
            "quantity": 10,
        },
        {"encoding": "multisig"},
        ["enhanced_sends"],
    ],
    [
        "issuance",
        {
            "source": DP["addresses"][0],
            "asset": "MAXI",
            "quantity": 2**63 - 1,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "Maximum quantity",
        },
        {"encoding": "multisig"},
    ],
    [
        "broadcast",
        {
            "source": DP["addresses"][0],
            "timestamp": 1388000000,
            "value": 1,
            "fee_fraction": DP["fee_multiplier"],
            "text": "Unit Test",
        },
        {"encoding": "multisig"},
    ],
    [
        "broadcast",
        {
            "source": DP["addresses"][2],
            "timestamp": 1288000000,
            "value": 1,
            "fee_fraction": 0.0,
            "text": "lock",
        },
        {"encoding": "multisig"},
    ],
    [
        "bet",
        {
            "source": DP["addresses"][0],
            "feed_address": DP["addresses"][0],
            "bet_type": 1,
            "deadline": 1388000001,
            "wager_quantity": 9,
            "counterwager_quantity": 9,
            "target_value": 0.0,
            "leverage": 5040,
            "expiration": 100,
        },
        {"encoding": "multisig"},
    ],
    [
        "bet",
        {
            "source": DP["addresses"][1],
            "feed_address": DP["addresses"][0],
            "bet_type": 0,
            "deadline": 1388000001,
            "wager_quantity": 9,
            "counterwager_quantity": 9,
            "target_value": 0.0,
            "leverage": 5040,
            "expiration": 100,
        },
        {"encoding": "multisig"},
    ],
    ["mine_empty_blocks", 100],  # 310100
    [
        "bet",
        {
            "source": DP["addresses"][1],
            "feed_address": DP["addresses"][0],
            "bet_type": 3,
            "deadline": 1388000200,
            "wager_quantity": 10,
            "counterwager_quantity": 10,
            "target_value": 0.0,
            "leverage": 5040,
            "expiration": 1000,
        },
        {"encoding": "multisig"},
    ],
    [
        "broadcast",
        {
            "source": DP["addresses"][0],
            "timestamp": 1388000002,
            "value": 1,
            "fee_fraction": DP["fee_multiplier"],
            "text": "Unit Test",
        },
        {"encoding": "multisig"},
    ],
    [
        "burn",
        {
            "source": DP["addresses"][4],
            "quantity": DP["burn_quantity"],
        },
        {"encoding": "multisig"},
    ],
    [
        "burn",
        {
            "source": DP["addresses"][5],
            "quantity": DP["burn_quantity"],
        },
        {"encoding": "multisig"},
    ],
    [
        "burn",
        {
            "source": DP["addresses"][6],
            "quantity": DP["burn_quantity"],
        },
        {"encoding": "multisig"},
    ],
    [
        "burn",
        {
            "source": DP["addresses"][8],
            "quantity": DP["burn_verysmall_quantity"],
        },
        {"encoding": "multisig"},
    ],
    [
        "dispenser",
        {
            "source": DP["addresses"][5],
            "asset": "XCP",
            "give_quantity": 100,
            "escrow_quantity": 100,
            "mainchainrate": 100,
            "status": 0,
        },
        {"encoding": "opreturn"},
    ],
    [
        "burn",
        {
            "source": DP["p2sh_addresses"][0],
            "quantity": int(DP["burn_quantity"] / 2),
        },
        {"encoding": "opreturn"},
    ],
    [
        "issuance",
        {
            "source": DP["p2sh_addresses"][0],
            "asset": "PAYTOSCRIPT",
            "quantity": 1000,
            "transfer_destination": None,
            "divisible": False,
            "lock": None,
            "reset": None,
            "description": "PSH issued asset",
        },
        {"encoding": "multisig", "multisig_pubkey": DP["pubkey"][DP["addresses"][0]]},
    ],
    [
        "send",
        {
            "source": DP["addresses"][0],
            "destination": DP["p2sh_addresses"][0],
            "asset": "DIVISIBLE",
            "quantity": DP["quantity"],
        },
        {"encoding": "multisig", "multisig_pubkey": DP["pubkey"][DP["addresses"][0]]},
    ],
    [
        "broadcast",
        {
            "source": DP["p2sh_addresses"][0],
            "timestamp": 1388000002,
            "value": 1,
            "fee_fraction": DP["fee_multiplier"],
            "text": "Unit Test",
        },
        {"encoding": "opreturn"},
    ],
    [
        "bet",
        {
            "source": DP["p2sh_addresses"][0],
            "feed_address": DP["p2sh_addresses"][0],
            "bet_type": 3,
            "deadline": 1388000200,
            "wager_quantity": 10,
            "counterwager_quantity": 10,
            "target_value": 0.0,
            "leverage": 5040,
            "expiration": 1000,
        },
        {"encoding": "opreturn"},
    ],
    # locked with an issuance after lock
    [
        "issuance",
        {
            "source": DP["addresses"][6],
            "asset": "LOCKEDPREV",
            "quantity": 1000,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "Locked asset",
        },
        {"encoding": "multisig"},
    ],
    [
        "issuance",
        {
            "source": DP["addresses"][6],
            "asset": "LOCKEDPREV",
            "quantity": 0,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "LOCK",
        },
        {"encoding": "multisig"},
    ],
    [
        "issuance",
        {
            "source": DP["addresses"][6],
            "asset": "LOCKEDPREV",
            "quantity": 0,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "changed",
        },
        {"encoding": "multisig"},
    ],
    [
        "burn",
        {"source": DP["p2wpkh_address"][0], "quantity": DP["burn_quantity"]},
        {"encoding": "opreturn"},
    ],
    ["mine_empty_blocks", 480],
    # force 2 enhanced sends
    [
        "send",
        {
            "source": DP["addresses"][0],
            "destination": DP["addresses"][1],
            "asset": "XCP",
            "quantity": DP["quantity"],
            "memo": "hello",
            "memo_is_hex": False,
            "use_enhanced_send": True,
        },
        {"encoding": "opreturn"},
    ],
    [
        "send",
        {
            "source": DP["addresses"][1],
            "destination": DP["addresses"][0],
            "asset": "XCP",
            "quantity": DP["quantity"],
            "memo": "fade0001",
            "memo_is_hex": True,
            "use_enhanced_send": True,
        },
        {"encoding": "opreturn"},
    ],
    ["mine_empty_blocks", 485],
    [
        "broadcast",
        {
            "source": DP["addresses"][4],
            "timestamp": 1388000000,
            "value": 1,
            "fee_fraction": DP["fee_multiplier"],
            "text": "Unit Test",
        },
        {"encoding": "multisig"},
    ],
    [
        "bet",
        {
            "source": DP["addresses"][4],
            "feed_address": DP["addresses"][4],
            "bet_type": 1,
            "deadline": 1388000001,
            "wager_quantity": 9,
            "counterwager_quantity": 9,
            "target_value": 0.0,
            "leverage": 5040,
            "expiration": 100,
        },
        {"encoding": "multisig"},
    ],
    # To test REQUIRE_MEMO
    [
        "broadcast",
        {
            "source": DP["addresses"][4],
            "timestamp": 1388000002,
            "value": 1,
            "fee_fraction": 0.0,
            "text": "options 0",
        },
        {"encoding": "multisig"},
        {"options_require_memo": True},
    ],
    [
        "broadcast",
        {
            "source": DP["addresses"][4],
            "timestamp": 1388000003,
            "value": 1,
            "fee_fraction": 0.0,
            "text": "lock",
        },
        {"encoding": "multisig"},
    ],
    # To test REQUIRE_MEMO
    [
        "broadcast",
        {
            "source": DP["addresses"][6],
            "timestamp": 1388000004,
            "value": 1,
            "fee_fraction": 0.0,
            "text": "options 1",
        },
        {"encoding": "multisig"},
        {"options_require_memo": True},
    ],
    # ['mine_empty_blocks', 490],
    [
        "order",
        {
            "source": DP["addresses"][0],
            "give_asset": "XCP",
            "give_quantity": DP["quantity"],
            "get_asset": "BTC",
            "get_quantity": round(DP["quantity"] / 125),
            "expiration": 2000,
            "fee_required": DP["fee_required"],
        },
        {"encoding": "multisig"},
    ],
    [
        "order",
        {
            "source": DP["addresses"][1],
            "give_asset": "BTC",
            "give_quantity": round(DP["quantity"] / 125),
            "get_asset": "XCP",
            "get_quantity": DP["quantity"],
            "expiration": 2000,
            "fee_required": 0,
        },
        {"encoding": "multisig", "exact_fee": DP["fee_provided"]},
    ],
    [
        "burn",
        {"source": DP["addresses"][2], "quantity": DP["burn_quantity"]},
        {"encoding": "multisig"},
    ],
    [
        "issuance",
        {
            "source": DP["addresses"][2],
            "asset": "DIVIDEND",
            "quantity": 100,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "Test dividend",
        },
        {"encoding": "multisig"},
    ],
    [
        "send",
        {
            "source": DP["addresses"][2],
            "destination": DP["addresses"][3],
            "asset": "DIVIDEND",
            "quantity": 10,
        },
        {"encoding": "multisig"},
    ],
    [
        "send",
        {
            "source": DP["addresses"][2],
            "destination": DP["addresses"][3],
            "asset": "XCP",
            "quantity": 92945878046,
        },
        {"encoding": "multisig"},
    ],
    [
        "issuance",
        {
            "source": DP["addresses"][0],
            "asset": "PARENT",
            "quantity": DP["quantity"] * 1,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "Parent asset",
        },
        {"encoding": "opreturn"},
    ],
    [
        "issuance",
        {
            "source": DP["addresses"][0],
            "asset": "PARENT.already.issued",
            "quantity": DP["quantity"] * 1,
            "transfer_destination": None,
            "divisible": True,
            "lock": None,
            "reset": None,
            "description": "Child of parent",
        },
        {"encoding": "opreturn"},
    ],
    [
        "fairminter",
        {
            "source": DP["addresses"][0],
            "asset": "FREEFAIRMIN",
            "asset_parent": "",
            "price": 0,
            "quantity_by_price": 1,
            "max_mint_per_tx": 10,
        },
        {"encoding": "opreturn"},
    ],
    [
        "fairminter",
        {
            "source": DP["addresses"][0],
            "asset": "PAIDFAIRMIN",
            "asset_parent": "",
            "price": 10,
            "quantity_by_price": 1,
            "max_mint_per_tx": 0,
        },
        {"encoding": "opreturn"},
    ],
    [
        "fairmint",
        {"source": DP["addresses"][0], "asset": "FREEFAIRMIN", "quantity": 0},
        {"encoding": "opreturn"},
    ],
    [
        "fairminter",
        {
            "source": DP["addresses"][0],
            "asset": "RAIDFAIRMIN",
            "asset_parent": "",
            "price": 10,
            "quantity_by_price": 1,
            "max_mint_per_tx": 10,
            "hard_cap": 30,
            "premint_quantity": 20,
        },
        {"encoding": "opreturn"},
    ],
    [
        "fairminter",
        {
            "source": DP["addresses"][0],
            "asset": "QAIDFAIRMIN",
            "asset_parent": "",
            "price": 10,
            "quantity_by_price": 1,
            "max_mint_per_tx": 0,
            "hard_cap": 50,
            "premint_quantity": 20,
            "start_block": 0,
            "end_block": 0,
            "soft_cap": 20,
            "soft_cap_deadline_block": 400000,
            "minted_asset_commission": 0.5,
        },
        {"encoding": "opreturn"},
    ],
    [
        "fairminter",
        {
            "source": DP["addresses"][1],
            "asset": "A160361285792733729",
            "asset_parent": "",
            "price": 10,
            "quantity_by_price": 1,
            "max_mint_per_tx": 0,
            "hard_cap": 50,
            "premint_quantity": 20,
            "start_block": 0,
            "end_block": 0,
            "soft_cap": 20,
            "soft_cap_deadline_block": 310520,
            "minted_asset_commission": 0.3,
            "burn_payment": False,
            "lock_description": True,
            "lock_quantity": True,
            "divisible": True,
            "description": "softcap description",
        },
        {"encoding": "multisig"},
    ],
    [
        "fairmint",
        {"source": DP["addresses"][1], "asset": "A160361285792733729", "quantity": 10},
        {"encoding": "opreturn"},
    ],
    [
        "fairmint",
        {"source": DP["addresses"][1], "asset": "A160361285792733729", "quantity": 20},
        {"encoding": "opreturn"},
    ],
    [
        "attach",
        {"source": DP["addresses"][0], "asset": "XCP", "quantity": 100},
        {"encoding": "multisig"},
    ],
    [
        "attach",
        {
            "source": DP["addresses"][0],
            "asset": "DIVISIBLE",
            "quantity": 1,
        },
        {"encoding": "multisig"},
    ],
    [
        "issuance",
        {
            "source": DP["addresses"][5],
            "asset": "TESTDISP",
            "quantity": 1000,
            "transfer_destination": None,
            "divisible": False,
            "lock": None,
            "reset": None,
            "description": "Test dispensers asset",
        },
        {"encoding": "multisig"},
    ],
    [
        "dispenser",
        {
            "source": DP["addresses"][5],
            "asset": "TESTDISP",
            "give_quantity": 100,
            "escrow_quantity": 100,
            "mainchainrate": 100,
            "status": 0,
        },
        {"encoding": "opreturn"},
    ],
    ["mine_empty_blocks", 703],
]
